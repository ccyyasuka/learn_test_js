<!DOCTYPE html>
<html lang="zh-cmn-Hans">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="x-ua-compatible" content="IE=edge, chrome=1" />
		<title>debounce</title>
		<style>
			#container {
				width: 100%;
				height: 200px;
				line-height: 200px;
				text-align: center;
				color: #fff;
				background-color: #444;
				font-size: 30px;
			}
		</style>
	</head>

	<body>
		<div id="root"></div>
		<script>
			// STEP1: 调用 createElement 来创建一个 React 元素，它有 type、props 和 children 三个参数。
			// createElement(
			// 	'h1',
			// 	{ class: 'greeting',href:"baidu.com",style:"background:red" },
			// 	createElement('a', { class: 'mya', id: 'myId' }, 'aaaaa')
			// );
			// 输出{
			//     type:"h1"
			//     props:{
			//         class:'greeting',
			//         href:"baidu.com",
			//         style:"background:red",
			//         children:[{
			//             type:"a"
			//             class:"mya"
			//             id:"myId"
			//             children:"aaaaa"
			//         }]
			//     }
			// }
			function createTextElement(text) {
				return {
					type: 'TEXT_ELEMENT',
					props: {
						nodeValue: text,
						children: [],
					},
				};
			}
			function createElement(type, props, ...children) {
				//这样传进来的children本就是一个数组了
				let res = {
					type,
					props: {
						...props,
						children: children.map(child => (typeof child === 'object' ? child : createTextElement(child))),
					},
				};
				return res;
			}
			let element_res = createElement(
				'h1',
				{ class: 'greeting', href: 'baidu.com', style: 'background:red' },
				createElement('a', { class: 'mya', id: 'myId' }, 'Hello World')
			);
			console.log('step1:', element_res);
			// step2: render函数
			// render接收一个react的Element和一个现实存在的dom，进行渲染
			let root = document.querySelector('#root');
			function render(element, container) {
				console.log(element);
				const dom =
					element.type === 'TEXT_ELEMENT'
						? document.createTextNode('')
						: document.createElement(element.type); //创建一个dom节点
				//赋予属性
				Object.keys(element.props)
					.filter(key => key !== 'children') //把props中所有除了children的属性保留下来
					.forEach(key => (dom[key] = element.props[key])); //把属性依次赋值给dom
				element.props.children.forEach(child => {
					render(child, dom);
				}); //递归调用，把孩子渲染在当前节点
				container.appendChild(dom);
			}
			render(element_res, root);
		</script>
	</body>
</html>
